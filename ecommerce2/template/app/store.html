{% extends 'app/layout/base.html' %}
{% load static %}

{% block content %}
		

		<!-- SECTION -->
		<div class="section">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row">
					<!-- ASIDE -->
					<div id="aside" class="col-md-3">
						<!-- aside Widget -->
						
						<!-- /aside Widget -->

						<!-- aside Widget -->
						<div class="aside">
							<h3 class="aside-title">Price</h3>
							<div class="price-filter">
								<div id="price-slider"></div>
								<div class="input-number price-min">
									<input id="price-min" type="number" min="0">
									<span class="qty-up">+</span>
									<span class="qty-down">-</span>
								</div>
								<span>-</span>
								<div class="input-number price-max">
									<input id="price-max" type="number" min="0">
									<span class="qty-up">+</span>
									<span class="qty-down">-</span>
								</div>
								<button id="filter-button">Apply</button>
							</div>
						</div>
						<!-- /aside Widget -->


						<!-- aside Widget -->
						<div class="aside">
							<h3 class="aside-title">Top selling</h3>
							<!-- Display top selling product -->
							<div class="product-widget">
								<div class="product-img">
									<img src="{{ top_selling_product.image.url }}" alt="{{ top_selling_product.name }}">
								</div>
								<div class="product-body">
									<p class="product-category">{{ top_selling_product.category }}</p>
									<h3 class="product-name"><a href="{% url 'product' top_selling_product.id %}">{{ top_selling_product.name }}</a></h3>
									<h4 class="product-price">${{ top_selling_product.price }} <del class="product-old-price">${{ top_selling_product.old_price }}</del></h4>
								</div>
							</div>
							<!-- /top selling product -->
						
							<!-- Loop through other top selling products -->
							{% for product in other_top_products %}
							<div class="product-widget">
								<div class="product-img">
									<img src="{{ product.image.url }}" alt="{{ product.name }}">
								</div>
								<div class="product-body">
									<p class="product-category">{{ product.category }}</p>
									<h3 class="product-name"><a href="{% url 'product' product.id %}">{{ product.name }}</a></h3>
									<h4 class="product-price">${{ product.price }} <del class="product-old-price">${{ product.old_price }}</del></h4>
								</div>
							</div>
							{% endfor %}
							
						</div>
					</div>
					<!-- /ASIDE -->

					<!-- STORE -->
					<div id="store" class="col-md-9">
						

						<!-- store products -->
						<div class="row" id="product-row">
							<!-- product -->
							{% for product in products %}
    						<div class="col-md-4 col-xs-6"  id="product-row">
        						<div class="product">
            						<div class="product-img">
                						<img src="{{ product.image.url }}" alt="{{ product.name }}">
            						</div>
            						<div class="product-body">
                						<p class="product-category">{{ product.category.name }}</p>
                						<h3 class="product-name"><a href="{% url 'product' product.id %}">{{ product.name }}</a></h3>
                						<h4 class="product-price">${{ product.price }}</h4>
                						<!-- You can add more product details here if needed -->
            						</div>
            						<div class="add-to-cart">
                					<button class="add-to-cart-btn"><i class="fa fa-shopping-cart"></i><a href="{% url 'add_to_cart' product.id %}"> add to cart</a></button>
            						</div>
        						</div>
    						</div>
    						{% endfor %}
							<!-- /product -->
						</div>
						<!-- /store products -->

						<!-- store bottom filter -->
						
						<div class="store-filter clearfix">
							<span class="store-qty">Showing 20-100 products</span>
							<ul class="store-pagination">
								{% if products.has_previous %}
								<a href="?page={{ products.previous_page_number }}"><li><<</li></a>
								{% endif %}
								{% for i in products.paginator.page_range %}
    							<a href="?page={{ i }}"><li>{{ i }}</li></a>
								{% endfor %}
								{% if products.has_next %}
								<a href="?page={{ products.next_page_number }}"><li>>></li></a>
								{% endif %}
								
							</ul>
						</div>
						<!-- /store bottom filter -->
					</div>
					<!-- /STORE -->
				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /SECTION -->

		
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
		<script>
		document.addEventListener('DOMContentLoaded', function() {
            const priceMinInput = document.getElementById('price-min');
            const priceMaxInput = document.getElementById('price-max');
            const filterButton = document.getElementById('filter-button');

            filterButton.addEventListener('click', updateURL);

            function updateURL() {
                const minPrice = priceMinInput.value;
                const maxPrice = priceMaxInput.value;

                if (minPrice && maxPrice) {
                    const searchParams = new URLSearchParams(window.location.search);
                    searchParams.set('min_price', minPrice);
                    searchParams.set('max_price', maxPrice);

                    window.location.search = searchParams.toString();
                }
            }
        });
		
    </script>

		{% endblock %}
